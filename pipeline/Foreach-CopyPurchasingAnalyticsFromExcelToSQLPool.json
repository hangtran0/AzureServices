{
	"name": "Foreach-CopyPurchasingAnalyticsFromExcelToSQLPool",
	"properties": {
		"activities": [
			{
				"name": "ForEach1",
				"type": "ForEach",
				"dependsOn": [],
				"userProperties": [],
				"typeProperties": {
					"items": {
						"value": "@variables('V_ListOfSheetNames')",
						"type": "Expression"
					},
					"isSequential": false,
					"batchCount": 4,
					"activities": [
						{
							"name": "Execute Pipeline1",
							"type": "ExecutePipeline",
							"dependsOn": [],
							"userProperties": [],
							"typeProperties": {
								"pipeline": {
									"referenceName": "CopyPurchasingAnalyticsFromExcelToSQLPool",
									"type": "PipelineReference"
								},
								"waitOnCompletion": false,
								"parameters": {
									"P_StorageAccountRawFiles": {
										"value": "@pipeline().parameters.P_StorageAccountRawFiles",
										"type": "Expression"
									},
									"P_ContainerRawFiles": {
										"value": "@pipeline().parameters.P_ContainerRawFiles",
										"type": "Expression"
									},
									"P_ExcelTableName": {
										"value": "@item()",
										"type": "Expression"
									},
									"P_SQLPoolServername": {
										"value": "@pipeline().parameters.P_SQLPoolServername",
										"type": "Expression"
									},
									"P_SQLPoolDBName": {
										"value": "@pipeline().parameters.P_SQLPoolDBName",
										"type": "Expression"
									},
									"P_DBSchema": {
										"value": "@pipeline().parameters.P_DBSchema",
										"type": "Expression"
									}
								}
							}
						}
					]
				}
			}
		],
		"parameters": {
			"P_StorageAccountRawFiles": {
				"type": "string",
				"defaultValue": "mdwdostordevpoc"
			},
			"P_ContainerRawFiles": {
				"type": "string",
				"defaultValue": "raw-purchase"
			},
			"P_SQLPoolServername": {
				"type": "string",
				"defaultValue": "mdwdosqlsrvrdevpoc.database.windows.net"
			},
			"P_SQLPoolDBName": {
				"type": "string",
				"defaultValue": "ddo_azuresqldw_dw"
			},
			"P_DBSchema": {
				"type": "string",
				"defaultValue": "purchase"
			}
		},
		"variables": {
			"V_ListOfSheetNames": {
				"type": "Array",
				"defaultValue": [
					"Dim Dates",
					"Dim Vendors",
					"Dim VendorGroups",
					"Dim Companies",
					"Dim Departments",
					"Dim Currencies",
					"Dim Products",
					"Dim ProductSubGroups",
					"Dim ProductGroups",
					"Dim PAMSTypes",
					"Dim Employees",
					"Dim SavingTypes",
					"Dim PaymentTerms",
					"Fact PurchaseRequests",
					"Fact PAMS",
					"Fact PurchaseOrders",
					"Fact Receives",
					"Fact Payments"
				]
			}
		},
		"annotations": []
	}
}